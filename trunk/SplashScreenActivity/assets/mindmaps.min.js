var Mindmaps={s:new Slatebox,canvas:{},container:"mindmaps-canvas",allow_edit:false,data:false,load:function(e){if(e){if(typeof e=="object"){this.data=e}else{this.data=JSON.parse(e)}return Mindmaps}else{console.error("1 parameter is required (json string)")}},to:function(e){if(e){this.container=e}this.render()},render:function(e){if(e==undefined||e==true){e=true}if(this.data){try{this.data.options.container=this.container;this.data.options.showZoom=!this.allow_edit;this.canvas=this.s.slate(this.data.options).canvas.init({imageFolder:"http://static.slatebox.com/cursors/"});var t={};for(var n in this.data.nodes){var r=this.data.nodes[n];r.options.allowContext=this.allow_edit;r.options.allowDrag=this.allow_edit;r.options.allowMenu=this.allow_edit;if(this.allow_edit){$("body").addClass("mindmaps-editable")}else{$("body").removeClass("mindmaps-editable")}t[r.options.id]=this.s.node(r.options)}this.canvas.nodes.addRange(t);for(var n in this.data.nodes){var r=this.data.nodes[n];for(var i in r.relationships.parents){var s=r.options.id;var o=r.relationships.parents[i].parentId;if(s!=o){t[s].relationships.addParent(t[o],{})}}for(var i in r.relationships.associations){var s=r.options.id;var o=r.relationships.associations[i].childId;if(s!=o){t[s].relationships.addAssociation(t[o],{})}}}this.canvas.init()}catch(u){if(e){console.warn("Mindmaps data is corrupted. Render default data instead.");this.new()}else{console.warn("Mindmaps data is corrupted.")}}}else{if(e){console.warn("Mindmaps data is empty. Render default data instead.");this.new()}else{console.warn("Mindmaps data is empty.")}}},toJSON:function(){return this.canvas.exportJSON()},"new":function(e){this.load('{"id":"mindmaps","options":{"id":"mindmaps","instance":"","name":"","description":"","containerStyle":{"width":"auto","height":"auto"},"viewPort":{"width":50000,"height":50000,"allowDrag":true,"left":3613,"top":4375,"originalWidth":50000,"zoom":{"w":50000,"h":50000,"l":5000,"t":5000,"r":1},"originalHeight":50000},"enabled":true,"showBirdsEye":false,"sizeOfBirdsEye":200,"showMultiSelect":false,"showZoom":true,"showStatus":false,"collaboration":{"allow":false,"showPanel":true,"useLongPolling":false,"jsonp":false,"localizedOnly":false,"userName":"","userProfile":"","userIP":"","sizeOfBirdsEye":200,"hubName":"slateHub","url":"","callbacks":{"onCollaboration":null,"onCollaborationStarted":null,"onCollaborationWired":null,"onUnauthorized":null}},"isPublic":false,"imageFolder":"http://static.slatebox.com/cursors/"},"nodes":[{"options":{"id":"first_node","name":"first_node","text":"แผนผังความคิด","isPinned":false,"isPinnedExact":false,"pinnedRowCount":5,"image":"","imageTiled":false,"xPos":3908,"yPos":4491,"height":40,"width":102,"borderWidth":2,"lineColor":"red","lineWidth":2,"lineOpacity":1,"allowDrag":true,"allowMenu":true,"allowContext":true,"backgroundColor":"90-#FFFFFF-#d9d9d9","foregroundColor":"#000","fontSize":13,"fontFamily":"Trebuchet MS","fontStyle":"normal","vectorPath":"roundedrectangle","rotationAngle":0,"link":{"show":false,"type":"","data":"","thumbnail":{"width":175,"height":175}}},"relationships":{"parents":[],"associations":[{"childId":"49701c9265cc","parentId":"first_node","isStraightLine":false,"lineColor":"red","lineOpacity":1,"lineWidth":2,"showParentArrow":false,"showChildArrow":false},{"childId":"e51346f8ebd7","parentId":"first_node","isStraightLine":false,"lineColor":"red","lineOpacity":1,"lineWidth":2,"showParentArrow":false,"showChildArrow":false}]}},{"options":{"id":"49701c9265cc","name":"first_node","text":"ความคิดที่ 1","isPinned":false,"isPinnedExact":false,"pinnedRowCount":5,"image":"","imageTiled":false,"xPos":3776,"yPos":4610,"height":48,"width":98,"borderWidth":2,"lineColor":"red","lineWidth":2,"lineOpacity":1,"allowDrag":true,"allowMenu":true,"allowContext":true,"backgroundColor":"90-#FFFFFF-#d9d9d9","foregroundColor":"#000","fontSize":13,"fontFamily":"Trebuchet MS","fontStyle":"normal","vectorPath":"roundedrectangle","rotationAngle":0,"link":{"show":false,"type":"","data":"","thumbnail":{"width":175,"height":175}},"showParentArrow":false,"showChildArrow":false,"reattachable":true},"relationships":{"parents":[],"associations":[{"childId":"49701c9265cc","parentId":"first_node","isStraightLine":false,"lineColor":"red","lineOpacity":1,"lineWidth":2,"showParentArrow":false,"showChildArrow":false}]}},{"options":{"id":"e51346f8ebd7","name":"first_node","text":"ความคิดที่ 2","isPinned":false,"isPinnedExact":false,"pinnedRowCount":5,"image":"","imageTiled":false,"xPos":4057,"yPos":4618,"height":40,"width":102,"borderWidth":2,"lineColor":"red","lineWidth":2,"lineOpacity":1,"allowDrag":true,"allowMenu":true,"allowContext":true,"backgroundColor":"90-#FFFFFF-#d9d9d9","foregroundColor":"#000","fontSize":13,"fontFamily":"Trebuchet MS","fontStyle":"normal","vectorPath":"roundedrectangle","rotationAngle":0,"link":{"show":false,"type":"","data":"","thumbnail":{"width":175,"height":175}}},"relationships":{"parents":[],"associations":[{"childId":"e51346f8ebd7","parentId":"first_node","isStraightLine":false,"lineColor":"red","lineOpacity":1,"lineWidth":2,"showParentArrow":false,"showChildArrow":false}]}}]}').render()},remove:function(){this.canvas=this.s.slate(this.data.options).canvas.init({imageFolder:"http://static.slatebox.com/cursors/"});this.canvas.init();this.canvas.exportJSON=function(){return false}},editable:function(e){this.allow_edit=e;this.reload()},reload:function(){this.load(this.toJSON()).render()}}